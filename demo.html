<!doctype html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://openlayers.org/en/v4.6.5/css/ol.css" type="text/css">
    <style>

        body {
            padding: 0;
            margin: 0;
        }

        .map {
            height: 100%;
            width: 100%;
        }

    </style>
    <script src="https://openlayers.org/en/v4.6.5/build/ol.js" type="text/javascript"></script>
    <title>xcube Tile Server Demo</title>
</head>
<body>
<div id="map" class="map"></div>
<script type="text/javascript">

    function getXYZ(url) {
        return fetch(url)
                .then(response => response.json())
                .then(options => {
                    return new ol.source.XYZ({
                        url: options.url,
                        projection: ol.proj.get(options.projection),
                        minZoom: options.minZoom,
                        maxZoom: options.minZoom,
                        tileGrid: new ol.tilegrid.TileGrid(options.tileGrid)
                    });
                });
    }

    var ne2Source = null;
    var demoSource = null;

    getXYZ('http://localhost:8080/xcts/ne2/tilegrid/ol4.json')
    .then(source => {
        ne2Source = source;
        return getXYZ('http://localhost:8080/xcts/demo/conc_chl/tilegrid/ol4.json')
    })
    .then(source => {
        demoSource = source;
        var map = new ol.Map({
            target: 'map',
            layers: [
                new ol.layer.Tile({source: ne2Source}),
                new ol.layer.Tile({source: demoSource}),
            ],
            view: new ol.View({
                center: ol.proj.fromLonLat([0, 0]),
                zoom: 0
            })
        });
    });

</script>
</body>
</html>